/*
    F0101Z2 Address Book backup and clear.sql
    Run this in oracle prior to loading zFile.
*/
/*
    First create a backup
*/
-- Clear backup tables
DROP TABLE TSAMPSON.CVDTA_F0101		PURGE; 	-- address book
DROP TABLE TSAMPSON.CVDTA_F0111		PURGE; 	-- contacts
DROP TABLE TSAMPSON.CVDTA_F01112	PURGE; 	-- Related Person
DROP TABLE TSAMPSON.CVDTA_F0115		PURGE; 	-- phone number
DROP TABLE TSAMPSON.CVDTA_F01151	PURGE; 	-- email addresses
DROP TABLE TSAMPSON.CVDTA_F0116		PURGE; 	-- address
DROP TABLE TSAMPSON.CVDTA_F0150		PURGE; 	-- Address Organization Structure
DROP TABLE TSAMPSON.CVDTA_F01161	PURGE; 	-- alternate address
DROP TABLE TSAMPSON.CVDTA_F0401		PURGE; 	-- Vendor Master
COMMIT;

-- Backup All CVDTA tables first
CREATE TABLE TSAMPSON.CVDTA_F0101	AS SELECT * FROM CVDTA.F0101; -- address book
CREATE TABLE TSAMPSON.CVDTA_F0111 	AS SELECT * FROM CVDTA.F0111; -- contacts
CREATE TABLE TSAMPSON.CVDTA_F01112 	AS SELECT * FROM CVDTA.F01112;-- Related Person
CREATE TABLE TSAMPSON.CVDTA_F0115 	AS SELECT * FROM CVDTA.F0115; -- phone number
CREATE TABLE TSAMPSON.CVDTA_F01151 	AS SELECT * FROM CVDTA.F01151;-- email addresses
CREATE TABLE TSAMPSON.CVDTA_F0116 	AS SELECT * FROM CVDTA.F0116; -- address
CREATE TABLE TSAMPSON.CVDTA_F0150 	AS SELECT * FROM CVDTA.F0150; -- Address Organization Structure
CREATE TABLE TSAMPSON.CVDTA_F01161 	AS SELECT * FROM CVDTA.F01161;-- alternate address
CREATE TABLE TSAMPSON.CVDTA_F0401 	AS SELECT * FROM CVDTA.F0401; -- Vendor Master

-- Make a place for data we are about to import
DELETE FROM CVDTA.F0101 -- address book
WHERE ABAN8 BETWEEN 72000 and 98999;

DELETE FROM CVDTA.F0111 -- contacts
WHERE WWAN8 BETWEEN 72000 and 98999;

DELETE FROM CVDTA.F01112 -- Related Person
WHERE CPAN8 BETWEEN 72000 and 98999;

DELETE FROM CVDTA.F0115 -- phone number
WHERE WPAN8 BETWEEN 72000 and 98999;

DELETE FROM CVDTA.F01151 -- email addresses
WHERE EAAN8 BETWEEN 72000 and 98999;

DELETE FROM CVDTA.F0116 -- address
WHERE ALAN8 BETWEEN 72000 and 98999;

DELETE FROM CVDTA.F0150  -- Address Organization Structure
WHERE MAOSTP = ''   -- This prevents deleting hierarchies created during configuration for Sales Reps and other specific types 
AND MAPA8 BETWEEN 72000 AND 98999;

DELETE FROM CVDTA.F01161 -- alternate address
WHERE WLAN8 > 72000; -- BETWEEN 72000 and 98999;

DELETE FROM CVDTA.F0401 -- Vendor Master
WHERE A6AN8 > 72000; -- BETWEEN 72000 and 98999;
COMMIT;

-- clear zFile
DELETE CVDTA.F0101Z2
COMMIT;

-- EOF
